linkerd-viz:
  grafana:
    enabled: false
  prometheus:
    enabled: true
  jaegerUrl : "http://jaeger.linkerd-viz.svc.cluster.local:16686/jaeger"
  grafaUrl: https://grafana-dev.teleport.mindtastic.lol
  dashboard:
    enforcedHostRegexp: ".*"

linkerd-jaeger:
  installNamespace: false
  namespace: linkerd-viz
  webhook:
    collectorSvcAddr: collector.linkerd-viz:55678
  collector:
    image:
      name: "ghcr.io/mindtastic/opentelemetry-transparency-processor"
      version: "dev-07021c6c421f7558cbea337607b4dc3f9b28f360"
    config: |
      receivers:
        otlp:
          protocols:
            grpc:
            http:
        opencensus:
        zipkin:
        jaeger:
          protocols:
            grpc:
            thrift_http:
            thrift_compact:
            thrift_binary:
      processors:
        batch:
        transparency:
          include:
            match_type: strict
            services: [linkerd-proxy]
          serviceMap:
            "echo.dev.api.mindtastic.lol": "kagami.kagami.svc.cluster.local:7666"
            "users.dev.api.mindtastic.lol": "user-service.user-service.svc.cluster.local:8000"
      extensions:
        health_check:
      exporters:
        jaeger:
          endpoint: jaeger.${POD_NAMESPACE}:14250
          tls:
            insecure: true
        otlp/honeycomb:
          endpoint: api.honeycomb.io:443
          headers:
            x-honeycomb-team: ${HONEYCOMB_TEAM_KEY}
      service:
        extensions: [health_check]
        pipelines:
          traces:
            receivers: [otlp,opencensus,zipkin,jaeger]
            processors: [transparency,batch]
            exporters: [jaeger,otlp/honeycomb]
